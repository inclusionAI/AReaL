experiment_name: tests-sft
trial_name: trial
cluster:
  n_nodes: 1
  n_gpus_per_node: 1
  fileroot: /tmp/areal/experiments
allocation_mode: megatron:d1
seed: 1
total_train_epochs: 1
total_train_steps: 16
tokenizer_path: ${actor.path}
train_dataset:
  type: sft
  path: openai/gsm8k
  batch_size: 16
saver:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  fileroot: ${cluster.fileroot}
evaluator:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  fileroot: ${cluster.fileroot}
stats_logger:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  fileroot: ${cluster.fileroot}
recover:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  fileroot: ${cluster.fileroot}

actor:
  experiment_name: ${experiment_name}
  trial_name: ${trial_name}
  path: Qwen/Qwen3-0.6B
  optimizer:
    type: adam
    lr: 3e-6
    weight_decay: 0.003
    beta1: 0.9
    beta2: 0.95
    eps: 1e-5
    lr_scheduler_type: cosine
    gradient_clipping: 1.0
  scheduling_spec:
    - task_type: worker
      port_count: 2
      gpu: 1
      cpu: 4
      mem: 32
      cmd: python3 -m areal.scheduler.rpc.rpc_server
